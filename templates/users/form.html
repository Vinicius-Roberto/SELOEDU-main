{% extends "base.html" %}

{% block title %}{{ 'Editar usuário' if user else 'Novo usuário' }} - SELOEDU{% endblock %}

{% block content %}
<div class="user-form-container">
  <div class="login-form">
    <h2>{{ 'Editar usuário' if user else 'Novo usuário' }}</h2>

    <form method="post" class="user-form">

      <!-- Nome -->
      <div class="form-group">
        <label for="nome">Nome</label>
        <input type="text" id="nome" name="nome"
               value="{{ user.nome if user else (form_data.nome if form_data else '') }}"
               required>
      </div>

      <!-- Email -->
      <div class="form-group">
        <label for="email">Email</label>
        <input type="email" id="email" name="email"
               value="{{ user.email if user else (form_data.email if form_data else '') }}"
               required>
      </div>

      <!-- Papel -->
      <div class="form-group">
        <label for="role">Papel</label>
        {% set r = user.role if user else (form_data.role if form_data else 'aluno') %}
        <select id="role" name="role">
          <option value="aluno" {{ 'selected' if r == 'aluno' else '' }}>Aluno</option>
          {% if current_user.is_authenticated and current_user.role != 'coordenador' %}
            <option value="coordenador" {{ 'selected' if r == 'coordenador' else '' }}>Coordenador</option>
          {% endif %}
        </select>
      </div>

      <!-- Senha -->
      <div class="form-group">
        <label for="password">Senha</label>
        <input type="password" id="password" name="password"
               {% if not user %}required{% endif %} minlength="6">
        {% if user %}
          <small class="form-text text-muted">
            Deixe em branco para manter a senha atual.
          </small>
        {% endif %}
      </div>

      <!-- Botões -->
      <div class="form-buttons">
        <button type="submit" class="btn btn-primary">Salvar</button>
        <a href="{{ url_for('users.index') }}" class="btn btn-secondary">Voltar</a>
      </div>
    </form>
  </div>
</div>
{% endblock %}
